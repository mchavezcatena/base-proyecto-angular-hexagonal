<nav class="navbar">
  <div class="navbar-container">
    <div class="navbar-brand" routerLink="/home">
      <h2>Sistema de Gestión</h2>
    </div>

    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu"
            (click)="toggleMobileMenu()"
            [class.active]="isMobileMenuOpen()"
            aria-label="Toggle navigation menu">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>

    <!-- Desktop Menu -->
    <div class="navbar-menu desktop-menu">
      <div class="navbar-nav" *ngIf="currentSession()">
        <a routerLink="/home" routerLinkActive="active" class="nav-link">Inicio</a>
        <a routerLink="/users" routerLinkActive="active" class="nav-link">Usuarios</a>
        <a routerLink="/roles" routerLinkActive="active" class="nav-link">Roles</a>
        <a routerLink="/assign-roles" routerLinkActive="active" class="nav-link">Asignar Roles</a>
      </div>

      <div class="navbar-actions">
        <!-- Theme Toggle -->
        <button class="theme-toggle-btn"
                (click)="toggleTheme()"
                [title]="themeLabel()"
                aria-label="Cambiar tema">
          <span class="theme-icon">{{ themeIcon() }}</span>
        </button>
        <div *ngIf="currentSession(); else loginButton" class="user-menu">
          <span class="user-email">{{ currentSession()!.email.value }}</span>
          <button class="btn btn-outline" (click)="logout()">Cerrar Sesión</button>
        </div>

        <ng-template #loginButton>
          <button class="btn btn-primary" routerLink="/login">Iniciar Sesión</button>
        </ng-template>
      </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay"
         [class.active]="isMobileMenuOpen()"
         (click)="closeMobileMenu()">
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" [class.active]="isMobileMenuOpen()">
      <div class="mobile-menu-header">
        <h3>Menú</h3>
        <button class="close-button" (click)="closeMobileMenu()" aria-label="Close menu">
          <span>✕</span>
        </button>
      </div>

      <div class="mobile-menu-content">
        <!-- User Info -->
        <div *ngIf="currentSession()" class="mobile-user-info">
          <div class="mobile-user-avatar">
            <span>{{ currentSession()!.email.value.charAt(0).toUpperCase() }}</span>
          </div>
          <div class="mobile-user-details">
            <span class="mobile-user-email">{{ currentSession()!.email.value }}</span>
            <span class="mobile-user-status">Conectado</span>
          </div>
        </div>

        <!-- Navigation Links -->
        <div class="mobile-nav" *ngIf="currentSession()">
          <a routerLink="/home"
             routerLinkActive="active"
             class="mobile-nav-link"
             (click)="closeMobileMenu()">
            <span class="nav-icon">🏠</span>
            Inicio
          </a>
          <a routerLink="/users"
             routerLinkActive="active"
             class="mobile-nav-link"
             (click)="closeMobileMenu()">
            <span class="nav-icon">👥</span>
            Usuarios
          </a>
          <a routerLink="/roles"
             routerLinkActive="active"
             class="mobile-nav-link"
             (click)="closeMobileMenu()">
            <span class="nav-icon">🔐</span>
            Roles
          </a>
          <a routerLink="/assign-roles"
             routerLinkActive="active"
             class="mobile-nav-link"
             (click)="closeMobileMenu()">
            <span class="nav-icon">🎯</span>
            Asignar Roles
          </a>
        </div>

        <!-- Mobile Actions -->
        <div class="mobile-actions">
          <!-- Mobile Theme Toggle -->
          <button class="mobile-theme-btn" (click)="toggleTheme()">
            <span class="btn-icon">{{ themeIcon() }}</span>
            {{ themeLabel() }}
          </button>

          <div *ngIf="currentSession(); else mobileLoginButton">
            <button class="mobile-logout-btn" (click)="logout(); closeMobileMenu()">
              <span class="btn-icon">🚪</span>
              Cerrar Sesión
            </button>
          </div>

          <ng-template #mobileLoginButton>
            <button class="mobile-login-btn" routerLink="/login" (click)="closeMobileMenu()">
              <span class="btn-icon">🔑</span>
              Iniciar Sesión
            </button>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</nav>
